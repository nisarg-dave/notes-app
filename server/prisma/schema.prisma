// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Tells Prisma that we want to generate the Prisma client
generator client {
  provider = "prisma-client-js"
}

// This plug in ensures that the schemas generated by Pothos matches the one in Prisma. Hence, matching the database schemas. That way we don't try to access or expose fields that don't exist.
// Generates Prisma types to use in Pothos
// Now everytime we run prisma generate -> this also generates new sets to types for Pothos specifically. 
generator pothos {
  provider = "prisma-pothos-types"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Needed to define relation in Tag model in order to know how to get to a Tag from an individual Note
// One to many relationship. One note can have many tags
model Note {
  id        String   @id @default(uuid())
  title     String
  body      String
  tags      Tag[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// @default means the default value is autoincremented 
// relation takes two fields, field in Tag model that matches field in Note model. noteId is the foreign key. 
model Tag {
  id     String  @id @default(uuid())
  label  String  @unique
  // Made these fields optional to allow for onDelete: Set Null, so when Note is delete, noteid set to null. On Update set to restrict to prevent noteid from being chaned during update.
  note   Note?   @relation(fields: [noteId], references: [id], onDelete: SetNull, onUpdate: Restrict)
  noteId String?
}
